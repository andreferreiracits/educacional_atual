(function(a){a.PaginationCalculator=function(b,c){this.maxentries=b;this.opts=c};a.extend(a.PaginationCalculator.prototype,{numPages:function(){return Math.ceil(this.maxentries/this.opts.items_per_page)},getInterval:function(f){var d=Math.ceil(this.opts.num_display_entries/2);var e=this.numPages();var c=e-this.opts.num_display_entries;var g=f>d?Math.max(Math.min(f-d,c),0):0;var b=f>d?Math.min(f+d,e):Math.min(this.opts.num_display_entries,e);return{start:g,end:b}}});a.PaginationRenderers={};a.PaginationRenderers.defaultRenderer=function(b,c){this.maxentries=b;this.opts=c;this.pc=new a.PaginationCalculator(b,c)};a.extend(a.PaginationRenderers.defaultRenderer.prototype,{format:function(d,c){if(c==null||c.length==0){return d}for(var b=0;b<c.length;b++){d=d.replace(new RegExp("\\{"+b+"\\}","gi"),c[b])}return d},createLink:function(b,e,d){var f,c=this.pc.numPages();b=b<0?0:(b<c?b:c-1);d=a.extend({text:b+1,classes:""},d||{});if(b==e){f=a("<span class='current'>"+d.text+"</span>")}else{f=a("<a>"+d.text+"</a>").attr("href",this.opts.link_to.replace(/__id__/,b))}if(d.classes){f.addClass(d.classes)}f.data("page_id",b);return f},appendRange:function(c,e,f,b){var d;for(d=f;d<b;d++){this.createLink(d,e).appendTo(c)}},getLinks:function(h,e){var f,b,c=this.pc.getInterval(h),g=this.pc.numPages(),d=a("<div class='pagination'></div>");if(this.opts.page_x_of_y_show_always){d.append(a(this.format("<span class='current prev'>"+this.opts.page_x_of_y_text+"</span>",[h+1,this.pc.numPages()])))}if(this.opts.first_text&&(h>0||this.opts.first_show_always)){d.append(this.createLink(0,h,{text:this.opts.first_text,classes:"prev"}))}if(this.opts.prev_text&&(h>0||this.opts.prev_show_always)){d.append(this.createLink(h-1,h,{text:this.opts.prev_text,classes:"prev"}))}if(c.start>0&&this.opts.num_edge_entries>0){b=Math.min(this.opts.num_edge_entries,c.start);this.appendRange(d,h,0,b);if(this.opts.num_edge_entries<c.start&&this.opts.ellipse_text){jQuery("<span>"+this.opts.ellipse_text+"</span>").appendTo(d)}}this.appendRange(d,h,c.start,c.end);if(c.end<g&&this.opts.num_edge_entries>0){if(g-this.opts.num_edge_entries>c.end&&this.opts.ellipse_text){jQuery("<span>"+this.opts.ellipse_text+"</span>").appendTo(d)}f=Math.max(g-this.opts.num_edge_entries,c.end);this.appendRange(d,h,f,g)}if(this.opts.next_text&&(h<g-1||this.opts.next_show_always)){d.append(this.createLink(h+1,h,{text:this.opts.next_text,classes:"next"}))}if(this.opts.last_text&&(h<g-1||this.opts.last_show_always)){d.append(this.createLink(this.maxentries,h,{text:this.opts.last_text,classes:"next"}))}a("a",d).click(e);return d}});a.fn.pagination=function(b,e){e=jQuery.extend({items_per_page:10,num_display_entries:10,current_page:0,num_edge_entries:0,link_to:"#",page_x_of_y_text:"Page {0} of {1}",first_text:"First",last_text:"Last",prev_text:"Prev",next_text:"Next",ellipse_text:"...",page_x_of_y_show_always:true,first_show_always:true,last_show_always:true,prev_show_always:true,next_show_always:true,renderer:"defaultRenderer",contentPlaceholder:null,dataSourceUrl:"",templateUrl:"",filterSet:new HashSet(),filterContainerId:"#filtro-container",containers:this,maxentries:0,callback:defaultCallback},e||{});e.maxentries=b;e.filterSet.opts=e;var g=this,f,d,h;function c(i){i.preventDefault();var j,k=a(i.target).data("page_id");g.data("current_page",k);j=f.getLinks(k,c);g.empty();j.appendTo(g);var l=e.callback(e,k,g);if(!l){if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}}return l}h=e.current_page;g.data("current_page",h);b=(!b||b<0)?1:b;e.items_per_page=(!e.items_per_page||e.items_per_page<0)?1:e.items_per_page;if(!a.PaginationRenderers[e.renderer]){throw new ReferenceError("Pagination renderer '"+e.renderer+"' was not found in jQuery.PaginationRenderers object.")}f=new a.PaginationRenderers[e.renderer](b,e);g.each(function(){this.selectPage=function(i){c(i)};this.prevPage=function(){var i=g.data("current_page");if(i>0){c(i-1);return true}else{return false}};this.nextPage=function(){var i=g.data("current_page");if(i<numPages()-1){c(i+1);return true}else{return false}}});d=f.getLinks(h,c);g.empty();d.appendTo(g);e.callback(e,h,g)}})(jQuery);function defaultCallback(a,c,b){$.ajax({url:a.templateUrl,cache:false,context:document.body,success:function(d){$.ajax({url:a.dataSourceUrl+"?filtro="+a.filterSet.toString(),cache:false,dataType:"json",success:function(e){var g=jsontemplate.Template(d,{more_formatters:JSON.stringify});var f=g.expand(e);a.contentPlaceholder.html(f);a.filterSet.container=$(a.filterContainerId);a.filterSet.render();AddEvents(a)}})}});return false}if(!Array.indexOf){Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){return a}}return -1}}function HashSet(a){this.opts=null;this.container=a;this._arr=new Array();this._value=new Array()}HashSet.prototype.get=function(a){return this._value[this._arr[a]]};HashSet.prototype.getKey=function(a){return this._arr[a]};HashSet.prototype.exists=function(c){var a=this._arr;var b=a.indexOf(c);return(b!=-1)};HashSet.prototype.getValueOfKey=function(a){return this._value[a]};HashSet.prototype.size=function(a){return this._arr.length};HashSet.prototype.toString=function(){var a="";for(var c=0;c<this.size();c++){var b=this.getKey(c);a+=("{"+b+":"+this.getValueOfKey(b)+"}")}return a};HashSet.prototype.render=function(){this.container.html("&nbsp;");if(this.size()>0){this.container.html("Filtrado por: ");for(var c=0;c<this.size();c++){var b=this.getKey(c);var d=$("<a href='#' title="+b+">X</a>");var e=this;d.click(function(f){e.remove($(this).attr("title"));e.opts.containers.pagination(e.opts.maxentries,e.opts);f.preventDefault()});var a=$("<span></span>");a.append(b.charAt(0).toUpperCase()+b.slice(1));a.append(d);this.container.append("&nbsp;");this.container.append(a)}}};HashSet.prototype.remove=function(d){var a=this._arr;var c=this._value;var b=a.indexOf(d);if(b!=-1){delete c[a[d]];a.splice(b,1);this.render()}};HashSet.prototype.add=function(c,d){var a=this._arr;var b=a.indexOf(c);if(b==-1){a.push(c);this.render()}this._value[c]=d};function AddEvents(c){var b=900;var a=200;$(".janela-configuracoes").position({my:"left top",at:"left bottom",of:$("#filtro-container")});$(".janela-configuracoes").hide();$(".show-window").toggle(function(g){$(".janela-configuracoes").each(function(){if($(this).is(":visible")){$(this).hide(0)}});var f="#"+$(this).attr("title");var d=$(f);var h=$(this);$(f+" .close-window").unbind("click");$(f+" .close-window").click(function(i){h.click();i.preventDefault()});$(".items-filtro").each(function(e){if(c.filterSet.exists(this.name)){this.value=c.filterSet.getValueOfKey(this.name)}else{this.value="default"}});d.css({"z-index":b});d.show(a);d.position({my:"left top",at:"left bottom",of:h});g.preventDefault()},function(g){var f="#"+$(this).attr("title");var d=$(f);d.hide(a);g.preventDefault()});$(".selecionar-todos").click(function(d){$(".lista-selecionavel").attr("checked",true);d.preventDefault()});$(".selecionar-nenhum").click(function(d){$(".lista-selecionavel").attr("checked",false);d.preventDefault()});$("#filtros .bt-enviar").click(function(d){$(".items-filtro").each(function(e){if(this.value!="default"){c.filterSet.add(this.name,this.value)}else{c.filterSet.remove(this.name)}});c.containers.pagination(c.maxentries,c);$("#filtros-fechar").click();d.preventDefault()});$("#filtros .bt-cancelar").click(function(d){$("#filtros-fechar").click();d.preventDefault()});return false};