var ativGeraisChk;var disciplinasChk=new Array();var atividadesChk=new Array();(function(a){a.fn.posiGantt=function(g){var i=this;var h=a(g.disciplinaSelector);var j=a(g.atividadeSelector);var q=a(g.atividadeTogglerSelector);var l=g.datasource;var s=g.prefsDatasource;var p=g.monthNames||["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];var b=g.monthNamesShort||["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];var v=g.dayNamesShort||["D","S","T","Q","Q","S","S"];var k=g.todayButton||"Hoje";var m=g.monthButton||"M";var z=g.weekButton||"S";var t=g.weekColumnFormat||"ddd d/M";var D=g.dayColumnFormat||"dd/MMM/yyyy";var f=g.weekTitleFormat||"dd[/MMM]{-dd/MMM/yy}";var C=g.dayTitleFormat||"dd/MMM/yyyy";var r=g.disciplinaSelectorTitle||"Selecione";var u=g.atividadeSelectorTitle||"Selecione atividade";var o=g.disciplina||"";var n=g.disciplinaIconClasses||[{id:2,className:"debatePP",alt:"Debate"},{id:3,className:"salavirtualPP",alt:"Sala virtual"},{id:4,className:"avaexePP",alt:"Avaliação/Exercício"},{id:5,className:"aulaPP",alt:"Aula"},{id:7,className:"entregaPP",alt:"Entrega de trabalho"},{id:15,className:"salavirtualmmPP",alt:"Sala virtual multimídia"},{id:17,className:"scormPP",alt:"Conteúdos SCORM"}];if(typeof(arguments[0])=="string"){i.fullCalendar.apply(i,arguments);return i}if(tipoVisualizacao=="D"){tipoVisualizacaoN="basicDay"}else{if(tipoVisualizacao=="M"){tipoVisualizacaoN="month"}else{tipoVisualizacaoN="basicWeek"}}i.fullCalendar({year:cursorDate.getFullYear(),month:cursorDate.getMonth(),date:cursorDate.getDate(),buttonText:{month:m,today:k,week:z},columnFormat:{day:D,week:t},defaultView:tipoVisualizacaoN,dayNamesShort:v,events:function(I,E,H){var F=B(I,E);var G=y(F);H(G)},eventClick:function(G,F,E){if(o==""){var H=G.id.split(",");if(G.start>new Date()){alert("A atividade ainda não pode ser acessada.");return}a.post(l,{what:"url",IdServico:parseInt(H[0]),IdItem:parseInt(H[1])},function(I){location.href=I})}},eventRender:function(H,G,F){var E=Math.random();a(G).find("a").addClass("icc_"+H.color);if(H.mandatory){a(G).find("a").prepend(a("<div/>").append(a("<img/>").attr("src","/LMS/StaticContent/Common/img/icon/ic_obrigatorio.png").attr("title","Atividade de participação obrigatória")).css("float","left").css("position","relative").css("top","1px"))}a(G).find("a").prepend(a("<div/>").addClass("iconPP").addClass("ice_"+H.color).addClass(H.iconClassName||"").attr("title",H.alt)).end().find("span").wrap("<div class='title' />");if(o!=""){a(G).find("a").css("cursor","default")}if(F.name=="basicDay"&&o==""){a(G).find("a").append(a("<div/>").addClass("t-"+(H.bandeira?"":"un")+"selected-check").attr("title",H.bandeira?"Concluído":"Não concluído").click(function(I){if(a(this).hasClass("t-selected-check")){a(this).removeClass("t-selected-check").addClass("t-unselected-check").attr("title","Não concluído")}else{a(this).removeClass("t-unselected-check").addClass("t-selected-check").attr("title","Concluído")}a.ajax({async:false,url:l,type:"post",data:{what:"bandeira",idServico:H.id.split(",")[0],idAtividade:H.id.split(",")[1]}});I.preventDefault();return false}))}},header:false,height:400,lazyFetching:false,monthNames:p,monthNamesShort:b,titleFormat:{day:C,month:"MMMM/yyyy",week:f},viewDisplay:function(E){if(E.name=="basicDay"){a(".fc-today").removeClass("fc-state-highlight")}else{a(".fc-today").addClass("fc-state-highlight")}}});Array.prototype.find=function(E,F){return G(this.sort(E),E,F);function G(I,M,N){var L=I.length;if(L<2){if(L==1&&M(I[0],N)==0){return 1}return 0}var H=Math.floor(L/2);var K=I.slice(0,H);var J=I.slice(H+1,L);if(M(I[H],N)>0){return G(K,M,N)}else{if(M(I[H],N)<0){return G(J,M,N)}else{return 1+G(K,M,N)+G(J,M,N)}}}};function e(F,E){return F.id==E.id?0:(F.id>E.id?1:-1)}function y(F){var G=[];var E=[];F.sort(e);a.each(F,function(H,I){if(F.find(e,I)>1){if(E.find(e,I)<1){I.color="99";E.push(I)}}else{G.push(I)}});return E.concat(G)}function B(H,F){var G=[];var E=0;a(".t-atividade-cb:checked").each(function(){E+=parseInt(this.value)});if(o==""){a(".t-disciplina-cb:checked").each(function(){var I=this;a.ajax({async:false,data:{what:"evento",start:Math.floor(H.getTime()/1000),end:Math.floor(F.getTime()/1000),disciplina:this.value,atividade:E,timeZoneOffSet:(new Date()).getTimezoneOffset()},dataType:"json",success:function(L,J,M){var K=a(I).closest(".dsc").colorCode();a.each(L,function(O,P){P.color=K;var N=parseInt(/(\d+),\d+/.exec(P.id)[1]);a.each(n,function(Q,R){if(R.id==N){P.iconClassName=R.className;P.alt=R.alt}})});G=G.concat(L)},type:"post",url:l})})}else{a.ajax({async:false,data:{what:"evento",start:Math.floor(H.getTime()/1000),end:Math.floor(F.getTime()/1000),disciplina:o,atividade:E,timeZoneOffSet:(new Date()).getTimezoneOffset()},dataType:"json",success:function(K,I,L){var J=a(".dsc:first").colorCode();a.each(K,function(N,O){O.color=J;var M=parseInt(/(\d+),\d+/.exec(O.id)[1]);a.each(n,function(P,Q){if(Q.id==M){O.iconClassName=Q.className;O.alt=Q.alt}})});G=G.concat(K)},type:"post",url:l})}return G}if(o==""){h.append(a("<span />").attr("id","disciplinaSelectorTitle").text(r))}h.append(a("<div />").attr("id","disciplinaSelector"));function d(E){i.fullCalendar("refetchEvents");if(a(E).val()=="0,0,0"){ativGeraisChk=(a(E).attr("checked"));a.ajax({url:s,type:"post",data:{what:"atualizaPreferencia",titulo:"ativGeraisChk",valor:ativGeraisChk}})}else{if(a(E).attr("checked")){disciplinasChk.push(a(E).val())}else{removeArrayElement(disciplinasChk,a(E).val())}a.ajax({url:s,type:"post",data:{what:"atualizaDisciplinas",disciplinaIds:disciplinasChk.join("-")}})}a("#calendarioCarregando").hide()}a.ajax({async:false,dataType:"json",type:"post",url:l,data:{what:"disciplina"},success:function(F,E,G){if(o==""){if(preferencias.ativGeraisChk){ativGeraisChk=true}a("#disciplinaSelector").append(a("<div/>").addClass("dsc").addClass("ice_01").append(a("<div/>").addClass("paleta")).append(a("<div/>").addClass("icc_01").addClass("atenua").append(a("<input type='checkbox' "+preferencias.ativGeraisChk+"/>").addClass("t-disciplina-cb").click(function(){a("#calendarioCarregando").show();setTimeout(function(){d(a(".icc_01 input"))},1)}).val("0,0,0")).append(a("<span/>").text("Atividades gerais")))).append(a("<div/>").addClass("dsc").addClass("ice_99").append(a("<div/>").addClass("paleta")).append(a("<div/>").addClass("icc_99").addClass("atenua").append(a("<span/>").text("Atividades associadas a várias áreas de estudo"))))}a.each(F,function(H,J){var I=H+2;if(o==""){if(J.isChecked){disciplinasChk.push(J.id)}}if(o==""||o==J.id){var K=a("<div/>").addClass("icc_"+(I<10?"0"+I:""+I)).addClass("atenua");if(o==""){a(K).append(a("<input type='checkbox' "+J.isChecked+"/>").addClass("t-disciplina-cb").click(function(){a("#calendarioCarregando").show();setTimeout(function(){d(a(".icc_"+(I<10?"0"+I:""+I)+" input"))},1)}).val(J.id))}a(K).append(a("<span/>").text(J.title));a("#disciplinaSelector").append(a("<div/>").addClass("dsc").addClass("ice_"+(I<10?"0"+I:""+I)).append(a("<div/>").addClass("paleta")).append(a(K)))}})}});a("#scrollingDiv").append(j.css("position","absolute").css("top","27px").css("left","410px").append(a("<div/>").attr("id","atividadeSelectorTitle").append(a("<span/>").text(u)).append(a("<a/>").text(" X ").attr("href","#").attr("id","bt-fecha-div").click(function(){q.click();return false})).append("<br />")).append(a("<div id='atividadeSelector'></div>")));j.fancyBorder();q.toggle(function(){j.show()},function(){j.hide()});function x(E){if(a(E).attr("checked")){atividadesChk.push(a(E).val())}else{removeArrayElement(atividadesChk,a(E).val())}}function A(){i.fullCalendar("refetchEvents");a.ajax({async:false,url:s,type:"post",data:{what:"atualizaAtividades",atividadeIds:"-"+atividadesChk.join("-")}})}a.ajax({async:false,dataType:"json",type:"post",url:l,data:{what:"atividade"},success:function(F,E,G){a("#atividadeSelector").append(a("<br/>"));a.each(F,function(H,I){if(I.isChecked){atividadesChk.push(I.id)}a("#atividadeSelector").append(a("<div />").css("height","20px").css("position","relative").css("margin-bottom","3px").append(a("<input />").addClass("t-atividade-cb").css("float","left").attr("type","checkbox").attr("value",I.id).bind("click",function(){x(this)})).append(a("<div />").css("position","absolute").css("top","-3px").css("left","13px").css("width","200px").append(a("<div />").addClass("iconPP").addClass("ice_99").addClass(I.icon).css("float","left").css("margin-left","5px")).append(a("<p />").css("font-size","11px").css("padding","3px 0px 0px").text(I.title))));a("#atividadeSelector input").last().attr("checked",I.isChecked)});a("#atividadeSelector").append(a("<br/>")).append(a("<div/>").attr("id","btAplicarFiltro").append(a("<a/>").text("Aplicar").addClass("bt").click(function(){A();q.click();return false}).attr("href","#")))}});i.fullCalendar("refetchEvents");function w(){a("#calendarioDiv").append(a("<div />").attr("id","balao1").css("position","absolute").css("top","230px").css("left","190px").css("z-index","100").css("width","276px").css("height","115px").append(a("<img />").attr("src","/LMS/StaticContent/Content/TES/cssimg/calendario/balao_atividades-do-calendario.png").css("width","276px").css("height","115px"))).append(a("<div />").attr("id","balao2").css("position","absolute").css("top","27px").css("left","375px").css("z-index","100").css("width","194px").css("height","141px").append(a("<img />").attr("src","/LMS/StaticContent/Content/TES/cssimg/calendario/balao_tipos-de-atividades.png").css("width","194px").css("height","141px")))}function c(){a("#balao1").remove();a("#balao2").remove()}if(o==""&&disciplinasChk.length==0&&!ativGeraisChk){w();a("#scrollingDiv a, #scrollingDiv input").click(function(){c()})}a("#scrollingDiv").append(a("<img />").attr("id","calendarioCarregando").attr("src","http://universitarioup.educacional.com.br/LMS/StaticContent/Common/img/icon/carregando.gif").css("position","absolute").css("top","200px").css("left","370px").css("z-index","999").hide())}})(jQuery);(function(a){a.fn.colorCode=function(){var b=a(this).attr("class");return b==null?"":/ic._(\d{1,2})/.exec(b)[1]}})(jQuery);