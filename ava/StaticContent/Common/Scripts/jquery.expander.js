(function(a){a.expander={version:"1.4.1",defaults:{slicePoint:100,preserveWords:true,widow:4,expandText:"read more",expandPrefix:"… ",expandAfterSummary:false,summaryClass:"summary",detailClass:"details",moreClass:"read-more",lessClass:"read-less",collapseTimer:0,expandEffect:"fadeIn",expandSpeed:250,collapseEffect:"fadeOut",collapseSpeed:200,userCollapse:true,userCollapseText:"read less",userCollapsePrefix:" ",onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null}};a.fn.expander=function(b){function n(a,b){var c="span",d=a.summary;if(b){c="div";if(j.test(d)&&!a.expandAfterSummary){d=d.replace(j,a.moreLabel+"$1")}else{d+=a.moreLabel}d='<div class="'+a.summaryClass+'">'+d+"</div>"}else{d+=a.moreLabel}return[d,"<",c+' class="'+a.detailClass+'"',">",a.details,"</"+c+">"].join("")}function o(a){var b='<span class="'+a.moreClass+'">'+a.expandPrefix;b+='<a href="#">'+a.expandText+"</a></span>";return b}function p(a,b){if(a.lastIndexOf("<")>a.lastIndexOf(">")){a=a.slice(0,a.lastIndexOf("<"))}if(b){a=a.replace(f,"")}return a}function q(a,b){b.stop(true,true)[a.collapseEffect](a.collapseSpeed,function(){var c=b.prev("span."+a.moreClass).show();if(!c.length){b.parent().children("div."+a.summaryClass).show().find("span."+a.moreClass).show()}})}function r(b,c,d){if(b.collapseTimer){l=setTimeout(function(){q(b,c);if(a.isFunction(b.onCollapse)){b.onCollapse.call(d,false)}},b.collapseTimer)}}var c="init";if(typeof b=="string"){c=b;b={}}var d=a.extend({},a.expander.defaults,b),e=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i,f=d.wordEnd||/(&(?:[^;]+;)?|[a-zA-Z\u00C0-\u0100]+)$/,g=/<\/?(\w+)[^>]*>/g,h=/<(\w+)[^>]*>/g,i=/<\/(\w+)>/g,j=/(<\/[^>]+>)\s*$/,k=/^<[^>]+>.?/,l;var m={init:function(){this.each(function(){function P(a){a.preventDefault();x.hide();D.hide();if(A.beforeExpand){E.beforeExpand.call(B)}w.stop(false,true)[E.expandEffect](K,function(){w.css({zoom:""});if(A.afterExpand){E.afterExpand.call(B)}r(E,w,B)})}var b,c,f,j,m,s,t,u,v,w,x,y=[],z=[],A={},B=this,C=a(this),D=a([]),E=a.meta?a.extend({},d,C.data()):d,F=!!C.find("."+E.detailClass).length,G=!!C.find("*").filter(function(){var b=a(this).css("display");return/^block|table|list/.test(b)}).length,H=G?"div":"span",I=H+"."+E.detailClass,J="span."+E.moreClass,K=E.expandSpeed||0,L=a.trim(C.html()),M=a.trim(C.text()),N=L.slice(0,E.slicePoint);if(a.data(this,"expander")){return}a.data(this,"expander",true);a.each(["onSlice","beforeExpand","afterExpand","onCollapse"],function(b,c){A[c]=a.isFunction(E[c])});N=p(N);m=N.replace(g,"").length;while(m<E.slicePoint){j=L.charAt(N.length);if(j=="<"){j=L.slice(N.length).match(k)[0]}N+=j;m++}N=p(N,E.preserveWords);s=N.match(h)||[];t=N.match(i)||[];f=[];a.each(s,function(a,b){if(!e.test(b)){f.push(b)}});s=f;c=t.length;for(b=0;b<c;b++){t[b]=t[b].replace(i,"$1")}a.each(s,function(b,c){var d=c.replace(h,"$1");var e=a.inArray(d,t);if(e===-1){y.push(c);z.push("</"+d+">")}else{t.splice(e,1)}});z.reverse();if(!F){v=L.slice(N.length);if(v===""||v.split(/\s+/).length<E.widow){return}u=z.pop()||"";N+=z.join("");v=y.join("")+v}else{v=C.find(I).remove().html();N=C.html();L=N+v;u=""}E.moreLabel=C.find(J).length?"":o(E);if(G){v=L}N+=u;E.summary=N;E.details=v;E.lastCloseTag=u;if(A.onSlice){f=E.onSlice.call(B,E);E=f&&f.details?f:E}var O=n(E,G);C.html(O);w=C.find(I);x=C.find(J);w.hide();x.find("a").unbind("click.expander").bind("click.expander",P);D=C.find("div."+E.summaryClass);if(E.userCollapse&&!C.find("span."+E.lessClass).length){C.find(I).append('<span class="'+E.lessClass+'">'+E.userCollapsePrefix+'<a href="#">'+E.userCollapseText+"</a></span>")}C.find("span."+E.lessClass+" a").unbind("click.expander").bind("click.expander",function(b){b.preventDefault();clearTimeout(l);var c=a(this).closest(I);q(E,c);if(A.onCollapse){E.onCollapse.call(B,true)}})})},destroy:function(){if(!this.data("expander")){return}this.removeData("expander");this.each(function(){var b=a(this),c=a.meta?a.extend({},d,b.data()):d,e=b.find("."+c.detailClass).contents();b.find("."+c.moreClass).remove();b.find("."+c.summaryClass).remove();b.find("."+c.detailClass).after(e).remove();b.find("."+c.lessClass).remove()})}};if(m[c]){m[c].call(this)}return this};a.fn.expander.defaults=a.expander.defaults})(jQuery)